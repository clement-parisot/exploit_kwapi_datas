#!/bin/bash
for file in `find ./kwapi-data/ -name *.json`;
do
    echo $file
    OFFSET_BEGIN=17
    OFFSET_END=-15
    # Truncate end
    (( length=$(cat $file | wc -l) + OFFSET_END ));
    sed -n "$OFFSET_BEGIN,$length p" $file | sed "s/values/data/g" | sed "s/timestamps/index/g" | sed "s/^.*to.*$//g" | sed "s/^.*type.*$//g" | sed "s/uid\"\: \(.*\),$/columns\"\: \[\1\],/g" | sed "s/^.*resolution.*$/{/g" | sed "s/^.*Unknown.*$//g" > $file.out
    rm $file
done
